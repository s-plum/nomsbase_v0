exports.add = function(db) {	return function(req, res) {		db.collection('counters').findAndModify(		{"_id": "recipeid"}, [], {$inc: {"seq": 1}}, {}		, function(err, doc) {			if (!doc) {				req.body['recipeid'] = new Date().getTime();			}			else {				req.body['recipeid'] = doc.seq;			}			db.collection('recipes').insert(req.body, function(err, doc) {				if (err) {					res.send('shit!');				}				else {					res.send('OK');				}			});		});			}}exports.update = function(db) {	return function(req, res) {		//req.body._id = new ObjectID(req.body._id);		var collection = db.collection('recipes');		collection.save(req.body, function(err, doc) {			console.log(req.body);			if (err) {				res.send('shit');			}			else {				res.send('OK');			}		});	}}exports.get = function(db) {	return function(req, res) {		var collection = db.collection('recipes');		collection.find({recipeid: parseInt(req.params.id)}).toArray(function(err, results) {			if (err) {				res.send('shit!');			}			else {				if (results.length > 0) {					res.send(results[0]);				}			}		})	}}exports.search = function(db) {	return function(req, res) {		var collection = db.collection('recipes');		collection.find({ $or: [{name: {$regex: req.params.query, $options: 'i'}},{"ingredients.name" : {$regex: req.params.query, $options: 'i'}}]}).toArray(function(err, results) {			if (err) {				res.send('shit!');			}			else {				res.send(results);			}		})	}}